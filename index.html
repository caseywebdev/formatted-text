<!doctype html>

<html>

  <head>
    <title>Formatted Text</title>
  </head>

  <body>
    <div id='main'></div>
    <script src='https://unpkg.com/react@16/umd/react.development.js'></script>
    <script src='https://unpkg.com/react-dom@16/umd/react-dom.development.js'></script>
    <script src='formatted-text.js'></script>
    <script>
      (function () {
        var React = window.React;
        var ReactDOM = window.ReactDOM;
        var FormattedText = window.FormattedText.default;

        const Test = ({text: initialText}) => {
          const [text, setText] = React.useState(initialText);
          return React.createElement('div', null,
            React.createElement('textarea', {
              onChange: ev => setText(ev.target.value),
              style: {width: 400, height: 200},
              value: text
            }),
            React.createElement(FormattedText, {
              linkRenderer: function (link) {
                var url = link.url;
                var text = link.text;

                var YT = /^(?:https?:\/\/)?(?:youtu\.be\/(\w+)|(?:www\.)?youtube.com\/watch\?v=(\w+))$/;
                var match = url.match(YT);
                if (match) {
                  var id = match[1] || match[2];
                  return React.createElement('iframe', {
                    width: 560,
                    height: 315,
                    src: 'https://www.youtube.com/embed/' + id,
                    frameBorder: 0,
                    allowFullScreen: true
                  });
                }

                return React.createElement('a', {href: url}, text);
              }
            }, text)
          );
        };

        ReactDOM.render(React.createElement(Test, {
          text: [
            'Single line paragraph',
            '',
            'Double line',
            'paragraph',
            '',
            'foo@example.com.us',
            '(foo@example.com)',
            '[foo@example.com].',
            '<example.com>?',
            'https://example.com!',
            'joe.example@example.org',
            'http://localhost',
            'foo.bar',
            'foo...bar',
            '',
            'Custom Link Renderer!',
            'https://youtu.be/6W6y7YhHdVE'
          ].join('\n')
        }), document.getElementById('main'));
      })();
    </script>
  </body>

</html>
